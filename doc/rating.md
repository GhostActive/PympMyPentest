# Rating

The `Rating` enumeration class contains different items to map priorisation level for vulnerabilities.

## Overview

The class contains the following items:

| Name | Item | Priority | CVSS v3.X Score |
| ---- | ---- | :------: | :-----------: |
| Unknown | Rating.UNKNOWN | -1 | - |
| None | Rating.NONE | 0 | 0.0 |
| Low | Rating.LOW | 1 |  0.1 - 3.9 |
| Medium | Rating.MEDIUM | 2 | 4.0 - 6.9 |
| High | Rating.HIGH | 3 | 7.0 - 8.9 |
| Critical | Rating.CRITICAL | 4 | 9.0 - 10.0 |

## Constructor

The class `Rating` supports different ways to create instances. As the class `Rating` is an enum, instances can be initialized by calling a concrete item directly:

```Python
>>> r = Rating.MEDIUM
>>> r
<Rating.MEDIUM: (2, 'Medium')>
```

The class also implements the build-in method `__call__`, which expects one value as parameter. The input value can be one of the following data types:

```Python
# str is interpreted case-insensitive as "Name"
>>> r = Rating("Medium")
>>> r
<Rating.MEDIUM: (2, 'Medium')>

# int is interpreted as "Priority"
>>> Rating(2)
<Rating.MEDIUM: (2, 'Medium')>

# float is interpreted as "CVSS v3.X Score"
>>> Rating(5.3)
<Rating.MEDIUM: (2, 'Medium')>

```

Within the method `__call__`, depending on the data type of the input value, one of the following explicit constructor functions are invoked:

```Python
# create instance by "Name" (str)
>>> r = Rating.from_name("Medium")
>>> r
<Rating.MEDIUM: ('Medium', 2)>

# create instance by "Priority" (int)
>>> Rating.from_priority(2)
<Rating.MEDIUM: ('Medium', 2)>

# create instance by "CVSS v3.X Score" (float)
>>> Rating.from_cvss_score(5.3)
<Rating.MEDIUM: ('Medium', 2)>
```

## Sorting

The class `Rating` is sortable based on the rating's priority to support sorting a list of findings by their severity. 

Example: The following example shows a simple sort process of a list of ratings.

```Python
>>> ratings = [Rating.MEDIUM, Rating.NONE, Rating.LOW]
>>> sorted(ratings)
[<Rating.NONE: (0, 'None')>, <Rating.LOW: (1, 'Low')>, <Rating.MEDIUM: (2, 'Medium')>]
>>> sorted(ratings, reverse=True)
[<Rating.MEDIUM: (2, 'Medium')>, <Rating.LOW: (1, 'Low')>, <Rating.NONE: (0, 'None')>]
```

Example: Sorting a list of findings (e.g. as dict) containing the field "severity"

```Python
>>> sorted(findings, key=operator.itemgetter("severity"))
```

## See also

* [CVSS3.1 Specification](https://www.first.org/cvss/v3.1/specification-document)