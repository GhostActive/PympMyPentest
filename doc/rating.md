# Rating

The `Rating` enumeration class contains different items to map severities of vulnerabilities. The class contains the following items:

| Name | Item | Priority | CVSS v3.X Score |
| ---- | ---- | :------: | :-----------: |
| Unknown | Rating.UNKNOWN | -1 | - |
| None | Rating.NONE | 0 | 0.0 |
| Low | Rating.LOW | 1 |  0.1 - 3.9 |
| Medium | Rating.MEDIUM | 2 | 4.0 - 6.9 |
| High | Rating.HIGH | 3 | 7.0 - 8.9 |
| Critical | Rating.CRITICAL | 4 | 9.0 - 10.0 |

Items provide the properties `name`, `priority` and `item`, e.g.

```Python
>>> r = Rating.MEDIUM
>>> r.name
'Medium'
>>> r.priority
2
>>> r.item
(2, 'Medium')
```

## Constructor

The class `Rating` supports different ways to create instances. As the class `Rating` is an enum, instances can be initialized by calling a concrete item directly:

```Python
>>> r = Rating.MEDIUM
>>> r
<Rating.MEDIUM: (2, 'Medium')>
```

The class also implements the build-in method `__call__`, which expects one value as parameter. The input value can be one of the following data types:

```Python
# str is interpreted (case-insensitive) as "Name"
>>> r = Rating("Medium")
>>> r
<Rating.MEDIUM: (2, 'Medium')>

# int is interpreted as "Priority"
>>> Rating(2)
<Rating.MEDIUM: (2, 'Medium')>

# float is interpreted as "CVSS v3.X Score"
>>> Rating(5.3)
<Rating.MEDIUM: (2, 'Medium')>

```

Internally, the method `__call__` invoke, depending on the data type of the input value, one of the following constructor methods:

```Python
# Create instance by "Name" (str)
>>> r = Rating.from_name("Medium")
>>> r
<Rating.MEDIUM: ('Medium', 2)>

# Create instance by "Priority" (int)
>>> Rating.from_priority(2)
<Rating.MEDIUM: ('Medium', 2)>

# Create instance by "CVSS v3.X Score" (float)
>>> Rating.from_cvss_score(5.3)
<Rating.MEDIUM: ('Medium', 2)>
```

## Sorting

The class `Rating` is sortable based on the item's priority:

```Python
>>> ratings = [Rating.MEDIUM, Rating.NONE, Rating.LOW]
>>> sorted(ratings)
[<Rating.NONE: (0, 'None')>, <Rating.LOW: (1, 'Low')>, <Rating.MEDIUM: (2, 'Medium')>]
>>> sorted(ratings, reverse=True)
[<Rating.MEDIUM: (2, 'Medium')>, <Rating.LOW: (1, 'Low')>, <Rating.NONE: (0, 'None')>]
```

**Example** - Sorting a list of findings (e.g. as dict) containing the field "severity"

```Python
>>> finding1 = {"severity":Rating.MEDIUM}
>>> finding2 = {"severity":Rating.LOW}
>>> finding3 = {"severity":Rating.HIGH}
>>> findings = [finding1, finding2, finding3]
>>> findings
[{'severity': <Rating.MEDIUM: (2, 'Medium')>}, {'severity': <Rating.LOW: (1, 'Low')>}, {'severity': <Rating.HIGH: (3, 'High')>}]
>>> sorted(findings, key=operator.itemgetter("severity"))
[{'severity': <Rating.LOW: (1, 'Low')>}, {'severity': <Rating.MEDIUM: (2, 'Medium')>}, {'severity': <Rating.HIGH: (3, 'High')>}]
```

## See also

* [CVSS3.1 Specification](https://www.first.org/cvss/v3.1/specification-document)