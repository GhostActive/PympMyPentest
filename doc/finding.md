# Finding Objects

> **Note:** A template file in .yaml format is available under [src/templates/finding.yaml](https://github.com/GhostActive/PympMyPentest/blob/main/src/templates/finding.yaml)

- [Overview](#overview) - Predefined fields that map a concrete vulnerability
- [Implementation](#implementation) - 
- [Receipes](#receipes) - 

## Overview

This section contains the documentation about suggestions for predefined fields within finding objects.

- [Meta Information](#meta-information)
- []()
- []()

### Meta Information

*Meta information* are non-content fields to support the processing of finding objects.

| Name | Description | Data Type | Example |
| ---- | ----------- | :----: | -------- |
| id      | Unique identifier representing the finding object, e.g. UUID, incremented or random integer, char sequence derived from title and weakness, ...  | [int](https://docs.python.org/3/library/stdtypes.html#typesnumeric), [str](https://docs.python.org/3/library/string.html), [UUID](https://docs.python.org/3/library/uuid.html#uuid.uuid4) | *30840237-1dcb-44a4-a1d7-56db8dfe116d* |
| created | Creation date of the finding object, e.g. in [ISO format](https://docs.python.org/3/library/datetime.html#datetime.date.fromisoformat) (YYYY-MM-DD) | [str](https://docs.python.org/3/library/string.html), [date](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04*|
| status \*  | Current state assigned to finding object, e.g. *"Open"*, *"False Positive"*, *"Risk Accepted"* or *"Closed"* . The field could also be implemented as an enumeration class similar to [Rating](https://docs.python.org/3/library/string.html). | [str](https://docs.python.org/3/library/string.html) | *Open* |
| tags \*\*    | Additional information to categorize and group findings | [List](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists)[[str](https://docs.python.org/3/library/string.html)] | *en*, *web*, *input validation*, *CWE-89*  |

 \* The values for *status* are taken from a tester's perspective. For development teams the list can be extended, e.g. with *"In Review*", *"Approved"*, *"In Progress"*.

\*\* The field `tag` can also contain the following information:
* The content's language, e.g. *"en"* (for english) - useful if finding templates are managed in multiple languages
* Concrete technology or vendor names, if the vulnerability occurs specifically in the context of a product, e.g. *"hadoop"*, *"kubernetes"* or *"apache"*
* Corresponding *CWE-ID* and *CVE-ID* (if existing), e.g. *"CWE-89"* for *SQL Injection*
* Key aspects or categories from testing guides (e.g. [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/stable/)), e.g. *"configuration"*, *"authentication"*, ...
* Test type, e.g. *web*, *network*, *sca* (source code analysis), *hardening*, *mobile*, ...

Note that the *CWE-ID* (e.g. CWE-89 for SQL Injection vulnerabilities) could also be inserted as a stand-alone field. But not for every vulnerability exists a suitable *CWE-ID*. To avoid unnecessary empty fields, the *CWE-ID* is listed as an optional *tag* in the approach shown above - same for *CVE-ID*s.

### Content

Items describing an concrete vulnerability:

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | :-------: | ------- |
| weakness    | General type of the concrete finding | [`str`](https://docs.python.org/3/library/string.html) | Cross-Site Scripting, SQL Injection |
| title       | Short description of the finding | [`str`](https://docs.python.org/3/library/string.html) | Insuffiecent Input Validation in Login Form |
| description | Detailed description of the weakness | [`str`](https://docs.python.org/3/library/string.html) | - |
| result      | Detailed description of the finding with cause and explotation | [`str`](https://docs.python.org/3/library/string.html) | - |
| impact      | Consequences of an exploation | [`str`](https://docs.python.org/3/library/string.html) | - |
| affects     | Affected systems, components or functionality | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *http://localhost/login*, *127.0.0.1* |
| figures (optional) | Pictures to visualize the description or demonstrate the impact | [`str`](https://docs.python.org/3/library/string.html) | - |
| pocs (optional) | Proof of concept about how to exploit the vulnerability | [`List[Dict]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |
| severity    | Rating of the finding | [`str`](https://docs.python.org/3/library/string.html), [`Rating`](https://github.com/GhostActive/PympMyPentest/blob/main/doc/rating.md) | *None*, *Low*, *Medium*, *High*, *Critical* |
| mitigation  | Recommendation and steps to solve the finding | [`str`](https://docs.python.org/3/library/string.html) | - |
| references (optional)   | Further reading about, for example, the cause and recommendation | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |
| retest (optional)     | Information about retests (e.g. date, updated status, result) appended by its date of performance | [`List[Dict]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |

### Further Items

Further ideas or non-frequent used information:

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | ------- | ------- |
| filter            | Additional features to simplify the filtering process | [`str`](https://docs.python.org/3/library/string.html), [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *Active*, *Inactive*, *Draft*, *Accept*, *Skip* |
| hash or signature | Integer or character sequence to identify objects with same content over a set of items (e.g. by hashing) - useful to identify same security issues in repeated tests and test automation | [`int`](https://docs.python.org/3/library/stdtypes.html#typesnumeric), [`str`](https://docs.python.org/3/library/string.html) | 7838683416822932106 |
| updated           | Date, when the object was last time modified or touched | [`date`](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04* |

## Implementation

`Finding` objects can be represented as a class implementation or by the data type [`dict`](https://docs.python.org/3/tutorial/datastructures.html#dictionaries). The better implementation depends on the specific context in which the Finding object is used - for more information see [here](https://github.com/GhostActive/PympMyCodingSkills/blob/main/content/dict.md#item-1-dict-vs-class).

Common scenarios including the use of `Finding` instances are:

- Convert raw results of a tool's output to standardized finding format.
- Read and Write finding objects from database, API or file system.
- Create and show views of a finding model for reporting, vulnerability management, etc..

## Recipes

- [Item 1]() - Use the `Collector` class
- [Item 2]() - Use .yaml files for vulnerability documentation
- [Item 3]() - Convert severity from `str` to `Rating`


### Item 1: Use the `Collector` class

Example 1 and 2 can be combined using [`Collector`](https://github.com/GhostActive/PympMyPentest/blob/main/doc/collector.md) class.

### Item 2: Use .yaml files for vulnerability documentation

Load findings from .yaml files 

```python
def loader(self, path: Path) -> Iterable[Dict]:
    """
    Load one or more finding objects (stored in .yaml format) from given file or
    directory. Returns finding objects as a list of dictionaries.
    """
    if path is None:
        return list()

    iterable = (path for path in Path(path).iterdir()
        if path.name.endswith(".yaml")) if path.is_dir() else [path]

    for path in iterable:
        with open(path, "r") as stream:
            yield yaml.safe_load(stream)
```

### Item 3: Convert severity from `str` to `Rating`

[`Rating`](https://docs.python.org/3/library/string.html)

```python
severity = operator.itemgetter("severity")

finding["severity"] = Rating(severity(finding))
```


