# Finding Objects

- [Overview](#overview) - Predefined fields that map a concrete vulnerability
- [Usage](#usage) - 

## Overview

> **Note:** A template file in .yaml format is available under [src/templates/finding.yaml](https://github.com/GhostActive/PympMyPentest/blob/main/src/templates/finding.yaml)

This section contains the documentation about defined fields within finding objects.

### Meta Information

Additional data for processing `Finding` objects:

| Name | Description | Type | Example(s) |
| ---- | ----------- | :----: | -------- |
| id      | Unique identifier representing the finding object | [`str`](https://docs.python.org/3/library/string.html) | *30840237-1dcb-44a4-a1d7-56db8dfe116d* |
| created | Creation date of the finding | [`date`](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04* |
| status  | Current state assigned to finding object | [`str`](https://docs.python.org/3/library/string.html) | *Open*, *False Positive*, *Risk Accepted*, *Closed* |
| tags    | Additional information to categorize a finding | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *web*, *network*, *sca* (source code analysis), *hardening*, *mobile* |

### Content

Items describing an concrete vulnerability:

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | :-------: | ------- |
| weakness    | General type of the concrete finding | [`str`](https://docs.python.org/3/library/string.html) | Cross-Site Scripting, SQL Injection |
| title       | Short description of the finding | [`str`](https://docs.python.org/3/library/string.html) | Insuffiecent Input Validation in Login Form |
| description | Detailed description of the weakness | [`str`](https://docs.python.org/3/library/string.html) | - |
| result      | Detailed description of the finding with cause and explotation | [`str`](https://docs.python.org/3/library/string.html) | - |
| impact      | Consequences of an exploation | [`str`](https://docs.python.org/3/library/string.html) | - |
| affects     | Affected systems, components or functionality | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *http://localhost/login*, *127.0.0.1* |
| figures (optional) | Pictures to visualize the description or demonstrate the impact | [`str`](https://docs.python.org/3/library/string.html) | - |
| pocs (optional) | Proof of concept about how to exploit the vulnerability | [`List[Dict]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |
| severity    | Rating of the finding | [`str`](https://docs.python.org/3/library/string.html), [`Rating`](https://github.com/GhostActive/PympMyPentest/blob/main/doc/rating.md) | *None*, *Low*, *Medium*, *High*, *Critical* |
| mitigation  | Recommendation and steps to solve the finding | [`str`](https://docs.python.org/3/library/string.html) | - |
| references (optional)   | Further reading about, for example, the cause and recommendation | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |
| retest (optional)     | Information about retests (e.g. date, updated status, result) appended by its date of performance | [`List[Dict]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |

### Further Items

Further ideas or non-frequent used information:

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | ------- | ------- |
| filter            | Additional features to simplify the filtering process | [`str`](https://docs.python.org/3/library/string.html) | *Active*, *Inactive*, *Draft* |
| hash or signature | integer or character sequence to identify objects with same content over a set of items (e.g. by hashing) - useful to identify same security issues in repeated tests and test automation | [`int`](https://docs.python.org/3/library/stdtypes.html#typesnumeric), [`str`](https://docs.python.org/3/library/string.html) | 7838683416822932106 |
| updated           | date, when the object was last time modified or touched | [`date`](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04* |

## Usage

> **Note:** Example 1 and 2 can be combined using [`Collector`](https://github.com/GhostActive/PympMyPentest/blob/main/doc/collector.md) class. 

**Example 1:** Load findings from .yaml files 

```python
def loader(self, path: Path) -> Iterable[Dict]:
    """
    Load one or more finding objects (stored in .yaml format) from given file or
    directory. Returns finding objects as a list of dictionaries.
    """
    if path is None:
        return list()

    iterable = (path for path in Path(path).iterdir()
        if path.name.endswith(".yaml")) if path.is_dir() else [path]

    for path in iterable:
        with open(path, "r") as stream:
            yield yaml.safe_load(stream)
```

**Example 2:** Convert severity from `str` to [`Rating`](https://docs.python.org/3/library/string.html)

```python
severity = operator.itemgetter("severity")

finding["severity"] = Rating(severity(finding))
```


