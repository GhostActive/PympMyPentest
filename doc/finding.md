# Finding

> **Note**: In the following, the terms *vulnerability* and *finding* are used as synonyms.

*Finding* objects are used to describe and process vulnerabilities in IT security. The structure of *finding* objects discussed in the following is to use as orientation and can differ in the within a concrete implementation depending to the requirements. A template as yaml format, containing a basic structure, is available [*here*](https://github.com/GhostActive/PympMyPentest/blob/main/src/templates/finding.yaml).

**Content**

- [*Structure*](#structure)
- [*Implementation*](#implementation)
- [*Receipes*](#receipes)

## Structure

This section contains the documentation about suggestions for predefined fields within *finding* objects.

- [*Meta Information*](#meta-information)
- [*Content*](#content)
- [*Further Items*](#further-items)

### Meta Information

*Meta information* are "non-content" fields, as they do not contribute to the description of a specific vulnerability, but support the processing of vulnerabilities.

| Name | Description | Type | Example |
| ---- | ----------- | :----: | -------- |
| id      | Unique identifier representing a *finding* object, e.g. as UUID, incremented or random integer or sequence of characters derived from title and weakness. | [*int*](https://docs.python.org/3/library/stdtypes.html#typesnumeric), [*str*](https://docs.python.org/3/library/string.html), [*UUID*](https://docs.python.org/3/library/uuid.html#uuid.uuid4) | *30840237-1dcb-44a4-a1d7-56db8dfe116d* |
| created | Creation date of the finding object, e.g. in [*ISO format*](https://docs.python.org/3/library/datetime.html#datetime.date.fromisoformat) *YYYY-MM-DD*. | [*str*](https://docs.python.org/3/library/string.html), [*date*](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04*|
| status  | Current state assigned to finding object, e.g. *"Open"*, *"False Positive"*, *"Risk Accepted"* or *"Closed"*. | [*str*](https://docs.python.org/3/library/string.html) | *Open* |
| tags\*    | Additional information to group findings | [*List*](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists)\[[*str*](https://docs.python.org/3/library/string.html)] | *en*, *web*, *input validation*, *CWE-89*  |

\* Typical content for field *tag* is:
* The content's language, e.g. *"en"* (for english) - useful if finding templates are managed in multiple languages
* Concrete technology or vendor names, if the vulnerability occurs specifically in the context of a product, e.g. *"hadoop"*, *"kubernetes"* or *"apache"*
* Corresponding *CWE-ID* and *CVE-ID* (if existing), e.g. *"CWE-89"* for *SQL Injection*
* Key aspects or categories from testing guides (e.g. [*OWASP Testing Guide*](https://owasp.org/www-project-web-security-testing-guide/stable/)), e.g. *"configuration"*, *"authentication"*, ...
* Test type, e.g. *web*, *network*, *sca* (source code analysis), *hardening*, *mobile*, ...

Note that the *CWE-ID* (e.g. *CWE-89* for SQL Injection vulnerabilities) could also be inserted as a stand-alone field. But not for every vulnerability exists a suitable *CWE-ID*. To avoid unnecessary empty fields, the *CWE-ID* is listed as an optional *tag* in the approach shown above - same for *CVE-ID*s.

### Content

Items describing a concrete vulnerability.

**Required Fields**

| Name | Description | Type | Example |
| ---- | ----------- | :-------: | ------- |
| weakness    | Label of the vulnerability's corresponding weakness (e.g. from CWE) | [*str*](https://docs.python.org/3/library/string.html) | Cross-Site Scripting (XSS) |
| title       | Short and descriptive title of the vulnerability | [*str*](https://docs.python.org/3/library/string.html) | Insufficient Input Validation in Login Form (Reflected XSS)|
| description | Detailed weakness description of the vulnerability to show the general security issue. Analog to *Extended Description* from CWE, e.g. [*CWE-89: SQL Injection*](https://cwe.mitre.org/data/definitions/89.html)  | [*str*](https://docs.python.org/3/library/string.html) | *empty* |
| result      | Detailed description of the finding with cause and exploitation | [*str*](https://docs.python.org/3/library/string.html) | *empty* |
| impact      | Consequences of an exploitation | [*str*](https://docs.python.org/3/library/string.html) | *empty* |
| affects     | Affected systems, components or functionality | [*List*](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists)\[[*str*](https://docs.python.org/3/library/string.html)] | *https://localhost/login* |
| severity*    | Rating of the finding: *None*, *Low*, *Medium*, *High*, *Critical*  | [*str*](https://docs.python.org/3/library/string.html), [*Rating*](https://github.com/GhostActive/PympMyPentest/blob/main/doc/rating.md), Dict[str, Any] | *Medium* |
| mitigation  | Recommendation to solve the finding | [*str*](https://docs.python.org/3/library/string.html) | *empty* |

\* Examples for content of field *severity* based on simple style and Common Vulnerability Scoring System (CVSS):
```yaml
# Simple Rating
severity: Medium

# CVSS3.1 Rating
severity:
    rating: Medium
    score: 5.3
    vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
```

**Optional Fields**

Fields that can be used depending on the identified vulnerability to support its description.

| Name | Description | Type | Example |
| ---- | ----------- | :-------: | :-------: |
| figures | Images to visualize the reuslt's description or support the document of the impact | [*Dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries)\[[*str*](https://docs.python.org/3/library/string.html), [*Dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries)\[[*str*](https://docs.python.org/3/library/string.html), [str](https://docs.python.org/3/library/string.html)]] | - |
| pocs | Proof of concept about how to exploit the vulnerability containing the exploit's code | [*Dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries)\[[*str*](https://docs.python.org/3/library/string.html), [*Dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries)\[[*str*](https://docs.python.org/3/library/string.html), [*str*](https://docs.python.org/3/library/string.html)]] | - |
| references   | Further reading to topics in the context of the *finding* | [*Dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries)\[[*str*](https://docs.python.org/3/library/string.html), [*List*](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists)\[[*str*](https://docs.python.org/3/library/string.html)]] | - |
| retests | Information documenting a retest of a *vulnerability* | List[Dict[str, Any]] | - |

### Further Items

Further ideas or non-frequent used information:

| Name | Description | Type | Example |
| ---- | ----------- | ------- | ------- |
| filter            | Additional features to simplify the filtering process | [*str*](https://docs.python.org/3/library/string.html) | *Active*, *Inactive*, *Draft*, *Accept*, *Skip* |
| hash/ signature | Integer or character sequence to identify objects with same content over a set of items (e.g. by hashing) - useful to identify same security issues in repeated tests and test automation | [*int*](https://docs.python.org/3/library/stdtypes.html#typesnumeric), [*str*](https://docs.python.org/3/library/string.html) | 7838683416822932106 |
| updated           | Date, when the object was last time modified or touched | [*date*](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04* |

## Implementation

`Finding` objects can be represented as a class implementation or by using the data type [*dict*](https://docs.python.org/3/tutorial/datastructures.html#dictionaries). The better implementation depends on the specific context in which the `Finding` object is used - for more information about class vs. dict-based implementations see [*here*](https://github.com/GhostActive/PympMyCodingSkills/blob/main/content/dict.md#item-1-dict-vs-class).

Common scenarios including the use of `Finding` instances are:

- Converting raw results of a tool's output to standardized finding format
- Read or write finding objects from/to database, API or file system.
- Create and show views of a finding model for reporting, vulnerability management, etc..