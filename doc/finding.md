# `Finding` Objects

> **Note:** Template file in .yaml format available under [finding.yaml](https://github.com/GhostActive/PympMyPentest/blob/main/src/templates/finding.yaml)

### Introduction

### Items

#### Meta Information

| Name | Description | Type | Example(s) |
| ---- | ----------- | :----: | -------- |
| id      | Unique identifier representing the finding object | [`str`](https://docs.python.org/3/library/string.html) | *30840237-1dcb-44a4-a1d7-56db8dfe116d* |
| created | Creation date of the finding | [`date`](https://docs.python.org/3/library/datetime.html#datetime.date) | *2019-12-04* |
| status  | Current state assigned to finding object | [`str`](https://docs.python.org/3/library/string.html) | *Open*, *False Positive*, *Risk Accepted*, *Closed* |
| tags    | Additional information to categorize a finding | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *web*, *network*, *sca* (source code analysis), *hardening*, *mobile* |

#### Content

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | :-------: | ------- |
| weakness    | general type of the concrete finding | [`str`](https://docs.python.org/3/library/string.html) | Cross-Site Scripting, SQL Injection |
| title       | short description of the finding | [`str`](https://docs.python.org/3/library/string.html) | Insuffiecent Input Validation in Login Form |
| description | detailed description of the weakness | [`str`](https://docs.python.org/3/library/string.html) | - |
| result      | detailed description of the finding with cause and explotation | [`str`](https://docs.python.org/3/library/string.html) | - |
| impact      | consequences of an exploation | [`str`](https://docs.python.org/3/library/string.html) | - |
| affects     | affected systems, components or functionality | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | *http://localhost/login*, *127.0.0.1* |
| figures     | pictures to visualize the description or demonstrate the impact | [`str`](https://docs.python.org/3/library/string.html) | - |
| severity    | rating of the finding | [`str`](https://docs.python.org/3/library/string.html), [`Rating`](https://docs.python.org/3/library/string.html) | None, Low, Medium, High, Critical |
| mitigation  | recommendation and steps to solve the finding | [`str`](https://docs.python.org/3/library/string.html) | - |
| references | further reading about, for example, the cause and recommendation | [`List[str]`](https://docs.python.org/3/tutorial/datastructures.html#more-on-lists) | - |
| retest     | Text | Text | Text |

#### Recipes

| Name | Description | Type(s) | Example(s) |
| ---- | ----------- | ------- | ------- |
| filter            | Text | Text | Text |
| hash or signature | Text | Text | Text |
| updated           | Text | Text | Text |

### Usage

> **Note:** Example 1 and 2 can be combined using [`Collector`](https://github.com/GhostActive/PympMyPentest/blob/main/content/collector.md) class. 

**Example 1:** Load findings from .yaml files 

```python
def loader(self, path: Path) -> Iterable[Dict]:
    """
    Load one or more finding objects (stored in .yaml format) from given file or
    directory. Returns finding objects as dict.
    """
    if path is None:
        return list()

    iterable = (path for path in Path(path).iterdir()
        if path.name.endswith(".yaml")) if path.is_dir() else [path]

    for path in iterable:
        with open(path, "r") as stream:
            yield yaml.safe_load(stream)
```

**Example 2:** Convert severity from `str` to [`Rating`](https://docs.python.org/3/library/string.html)

```python
severity = operator.itemgetter("severity")

finding["severity"] = Rating(severity(finding))
```


