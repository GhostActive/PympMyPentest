# Reporting

*Listing 1*: Pipeline 
```python
# Initialize sequence of files containing finding objects
directory = "path/to/findings"
paths = [path for path in Path(directory).iterdir() if path.name.endswith(".yaml")]

# Phase 1: Load findings from files
findings = [prepare(finding) for finding in loader(paths) if accept(finding)]

# Phase 2: Processing finding objects
result = process(findings)
```

```python
severity = operator.itemgetter("severity")
weakness = operator.itemgetter("weakness")
title = operator.itemgetter("title")
```

## Step 1:
```python
findings = [prepare(finding) for finding in loader(paths) if accept(finding)]
```

```python
def loader(iterable: Iterable[Path]) -> Dict:
    """
    Creates a generator object loading finding objects from a sequence of
    given 'Path' objects as 'dict'.

    Args:
        iterable: a sequence of paths

    Returns:
        Return a generator object loading finding objects as 'dict'.
    """
    for path in iterable:
        with open(path, "r") as stream:
            yield yaml.safe_load(stream)
```

```python
def accept(finding):
    """
    Validates a finding object.

    Returns:
        Returns 'True' if the given finding object is valid; Otherwise false.
    """
    return True
```

```python
def prepare(finding):
    """
    Helper function to modify the given finding object.

    Returns:
        Returns the modified finding object.
    """
    finding["severity"] = Rating(severity(finding))

    return finding
```

## Step 2: 

```python
result = process(findings)
```

```python
def sort_findings(func):
    """
    Helper function to sort a sequence of findings. Findings are sorted by
    priority (descending), weakness (ascending) and title (ascending).

    Returns:
        Returns a sorted sequence of findings.
    """

    @functools.wraps(func)
    def wrapper(iterable, **kwargs):
        result = sorted(iterable, key=lambda f: (-severity(f).priority, weakness(f), title(f)))

        return func(result, **kwargs)

    return wrapper
```

```python
def group_findings(func):
    """
    Helper function to group by weakness.

    Returns:
        Returns a 'dict' containing weaknesses as keys and a list of
        corresponding findings as values.
    """

    @functools.wraps(func)
    def wrapper(iterable, **kwargs):
        result = defaultdict(list)

        for finding in iterable:
            result[weakness(finding)].append(finding)

        return func(result, **kwargs)

    return wrapper
```

```python
@sort_findings
@group_findings
def process(iterable):
    """

    """
    return iterable
```
